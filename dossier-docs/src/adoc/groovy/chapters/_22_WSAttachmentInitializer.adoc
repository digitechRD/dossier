[[_22_WSAttachmentInitializer]]
== WSAttachmentInitializer

=== Description

Ce type de script est utilisé lors de l'exécution des webservices sur les pièces jointes (ajout ou mise à jour).

=== Paramètres

cf. <<_01_CommonData,attributs communs>>.

[options="noheader",cols="2a,2a,3a"]
|===
3+|[.header]
Entrées|[.sub-header]
_Nom_|[.sub-header]
_Type_|[.sub-header]
_Description_
|*_docId*|Integer|Doc ID
|*_attData*|IWSAttachmentUpdateType|Attachment data
|*_mode*|ScriptModeRun|Mode

3+|[.header]
Sortie
|[.sub-header]
_Nom_|[.sub-header]
_Type_|[.sub-header]
_Description_
|*_result*|*com.digitech.dossier.script.model.impl.result.ScriptResultWSDocument** 2+**|contient les variables *secretLevel*, *codeFieldValues*, *ctxValues*
et *document*
|===

=== Exemple

Arrêt du chargement d'une pièce jointe si l'attribut *label* n'a pas été renseigné dans la requête.

[source, curl]
----
curl --location 'http://localhost:7373/dossierweb/rest/attachment/9097' \
  --header 'Authorization: Basic <credencials>' \
  --form 'attachmentData="{
      \"scriptCode\": \"test\"
  }";type=application/json'
  --form 'fileData=@"/path/document.docx"'
----

[source, groovy]
----
import com.digitech.dossier.script.model.impl.result.ScriptResultWSDocument
import com.digitech.dossier.webservices.type.WSAttachmentUpdateType

WSAttachmentUpdateType att = _attData
if(att.getLabel() == null) {
  _result.fillKOResult("Empty label")
}
----