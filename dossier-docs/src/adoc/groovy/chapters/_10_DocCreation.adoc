[[_10_DocCreation]]
== DocCreation

=== Description

Ce script est déclenché lors de la création d'un document, afin de préremplir les données du formulaire.

=== Paramètres

[options="noheader",cols="1a,1a,3a"]
|===
3+|[.header]
Entrées|[.sub-header]
_Nom_|[.sub-header]
_Type_|[.sub-header]
_Description_
|_logger|org.log4j.Logger|
|_userContext|IUserCoreContext|
|_document|IDocument|
|_updateFields|Collection<UpdateField>|
3+|[.header]
Sortie
|[.sub-header]
_Type_ 2+|[.sub-header]
_Description_
|ScriptResultDocCreationInitializer 2+|contient la variable *_updatedFields* définissant les champs affichés
|===

=== Example

Ajout de l'utilisateur courant en tant que rédacteur et de la date du jour lorsque l'on accède à la page de création d'un document.

[source, groovy]
----
import com.digitech.dossier.common.model.backend.airs.IDocument
import java.time.LocalDate
import java.time.format.DateTimeFormatter
import com.digitech.dossier.common.utils.FieldUtils
import com.digitech.dossier.common.model.backend.params.UpdateField

def today = LocalDate.now().format(DateTimeFormatter.ofPattern("dd/MM/yyyy"))
UpdateField uf = _updateFields.get('CR_DATE')
if(uf != null) {
  FieldUtils.setValue(_document as IDocument, 'CR_DATE', today)
}
uf = _updateFields.get('CR_REDACTEUR')
if(uf != null) {
 FieldUtils.setValue(_document as IDocument, 'CR_REDACTEUR', _userContext.getUserId())
}
----

.Exemple de création d'un Compte rendu
image:doc_creation_example.png[]