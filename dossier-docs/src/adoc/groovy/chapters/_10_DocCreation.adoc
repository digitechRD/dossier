[[_10_DocCreation]]
== DocCreation

=== Description

Ce script est déclenché lors de la création d'un document, afin de préremplir les données du formulaire.

=== Paramètres

cf. <<_01_CommonData,attributs communs>>.

[options="noheader",cols="2a,2a,3a"]
|===
3+|[.header]
Entrées|[.sub-header]
_Nom_|[.sub-header]
_Type_|[.sub-header]
_Description_
|*_document*|IDocument|Document
|*_updateFields*|Collection<UpdateField>|Champs du document
3+|[.header]
Sortie
|[.sub-header]
_Nom_|[.sub-header]
_Type_|[.sub-header]
_Description_
|*_result*|*com.digitech.dossier.script.model.impl.result.ScriptResultDocCreationInitializer*|contient la variable *updatedFields* définissant les champs
affichés
|===

=== Exemple

Ajout de l'utilisateur courant en tant que rédacteur et de la date du jour lorsque l'on accède à la page de création d'un document.

[source, groovy]
----
import com.digitech.dossier.common.model.backend.airs.IDocument
import java.time.LocalDate
import java.time.format.DateTimeFormatter
import com.digitech.dossier.common.utils.FieldUtils
import com.digitech.dossier.common.model.backend.params.UpdateField

def today = LocalDate.now().format(DateTimeFormatter.ofPattern("dd/MM/yyyy"))
UpdateField uf = _updateFields.get('CR_DATE')
if(uf != null) {
  FieldUtils.setValue(_document as IDocument, 'CR_DATE', today)
}
uf = _updateFields.get('CR_REDACTEUR')
if(uf != null) {
 FieldUtils.setValue(_document as IDocument, 'CR_REDACTEUR', _userContext.getUserId())
}
----

.Exemple de création d'un Compte rendu
image:examples/doc_creation_example.png[]