[[_17_FieldDependency]]
== {FieldDependency}

=== Description

Ce script est déclenché lorsque l'on souhaite avoir une dépendance entre les valeurs de certains champs.

=== Paramètres

cf. <<_01_CommonData,attributs communs>>.

[options="noheader",cols="2a,2a,3a"]
|===
|[.sub-header]
_Nom_|[.sub-header]
_Type_|[.sub-header]
_Description_
3+|[.header]
Entrées
|*_fieldToUpdate*|IField|Champ à mettre à jour
|*_fieldMap*|Map<String, IField>|Liste des champs
|*_updatedField*|IField|Champ que l'on modifie
|*_updateFieldValues*|Object|
|*_parameterMap*|List<IParameter>|
3+|[.header]
Entrées/sorties
|*_result*|*com.digitech.dossier.script.model.impl.result.IScriptResultModel<T>*|
|===

=== Exemple

Modification de la liste des choix pour le champ _Plan de classement_ lorsque la valeur du champ _Catégorie de document_ est modifiée.

[source, groovy]
----

List<SelectItem> selectItems = new SelectItemFactory().getAuthorities(_fieldToUpdate.getConfigField());
Term updatedFieldCode = getAuthorityListService().getTerm((Integer) _updatedField.getValue())

List<SelectItem> test = new ArrayList<>();
for(items in selectItems) {
  if(items.getValue() != null) {
    Term code = getAuthorityListService().getTerm((Integer) items.getValue());
    SelectItem item = new SelectItem()
    item.setLabel(code.getValues()[0] as String)
    item.setValue(code.getCode())
    test.add(item)
  }
}
List<SelectItem> filteredList = test.findAll({it.getValue().startsWith(updatedFieldCode.getCode() as String)})
HtmlSelectOneMenu component = ((HtmlSelectOneMenu)  ((UIComponent) _fieldToUpdate.getComponent()));
component.getChildren().get(0).setValue(filteredList);

/**
 * @return IAuthorityList the Authority List
 */
public static IAuthorityList getAuthorityListService() {
  return (IAuthorityList) ServiceManager.getInstance().getService(com.digitech.dossier.common.service.Constants.SERVICE_AIRS_AUTHORITYLIST_MGR);
}
----

.Exemple de choix pour la catégorie Commerce
image:examples/field_dependency_example_commerce.png[]

.Exemple de choix pour la catégorie Comptabilité
image:examples/field_dependency_example_compta.png[]